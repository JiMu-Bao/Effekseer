% No11. 3Dモデルを使おう！

<div class="main">

## 概要

本章では、3Dモデルを使用したエフェクトを作成します。
Effekseerでは、3Dモデルをパーティクルとして表示したり、生成方法の生成位置として使用できます。
それらの機能を使用してエフェクトを作成します。

<div align="center">
<table>
<tr>

<td>
<div align="center">
<img src="../../img/Tutorial/11_effect1.gif">
<p>本章で作成するエフェクト1</p>
</div>
</td>
<td>
<div align="center">
<img src="../../img/Tutorial/11_effect2.gif">
<p>本章で作成するエフェクト2</p>
</div>
</td>

</tr>
</table>
</div>

## 3Dモデル

Effekseerでは、fbxかmqoの3Dモデルを読み込めます。
fbxはBlender、Maya、3ds Max等、様々な3D編集ソフトから出力できる形式です。
mqoはMetasequoiaから出力できる形式です。

アニメーション付きのfbxにも対応しています。

使い方は2つあります。

1つ目は3Dモデルをパーティクルとして表示する方法です。

図

2つ目は生成方法の生成位置として3Dモデルを表示する方法です。

図

本章では、これらの使用方法について説明します。

<p>あらかじめ作成途中のエフェクトを下記のリンクからダウンロードできるようにしました。</p>
<div align="center">
<p><a href = "../../Sample/11_01_Sample.zip">ダウンロード</a></p>
</div>

## パーティクルとして表示

モデルをパーティクルとして表示します。

effect1.efkprojを開いてください。

スプライトと同じように、「描画」パネルから描画方法としてモデルを選択します。

そして、Model/model1.fbxをモデルとして読み込みます。

読み込んだ3Dモデルが表示されていることがわかります。

図

ただ、このままだと奥行き方向の描画がおかしくなることがあります。
その問題を解決するためにZ書き込み？をOnにしましょう。
Effekseerに限らず、3D描画には前後を判定する機能があります。
Z書き込みがオフだと、3Dモデルが描画されなかったものとして他のオブジェクトが描画されます。
そのため、奥行きがおかしんくなることがあります。

Z書き込みをOnにすると、奥行きも含め、正しく表示されていることがわかります。

図

不透明なオブジェクトならこれで問題ありませんが、モデルの形に沿ってエフェクトを出したいときもあります。

そのようなときは、描画パネルからライトをオフにします。
先ほどのZ書き込みもオフにします。

加えて画像を設定しましょう。
さらに、UVスクロールも設定します。

見栄えを良くするために3Dモデルを3つ配置します。

パラメーターは以下のようになります。

xxxxx

そうするとモデルの形に沿ってエフェクトが流れることがわかります。

図

## 生成方法の位置として使用

モデルを表示する以外にも生成方法の位置として使用できます。

モデルの頂点や面の位置にパーティクルを生成できます。

試してみましょう。

effect2.efkprojを開いてください。

生成方法でモデルを選択します。そしてモデルとしてModel/model2.fbxを読み込みます。
わかりやすくするために、生成位置種類を頂点にします。

パーティクルの画像にはxxxを設定します。
生成数も増やします。

パラメーターは以下のようになります。

xxx

モデルに沿ってパーティクルが配置されることがわかります。

図

リボンや軌跡と組み合わせることもできます。
その場合、モデルの頂点に沿ってリボンや軌跡が生成されます。

図

最後に、本章で作成されたエフェクトをダウンロードできるようにしてみました。

<div align="center">
<a href = "../../Sample/11_02_Sample.zip">ダウンロード</a>
</div>

## まとめ

本章では、3Dモデルを使用してエフェクトを作成しました。
次章では、Fカーブを使用して複雑な動きを再現します。

</div>
