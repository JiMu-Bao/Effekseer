% No13. 背景を歪ませよう！

<div class="main">

## 概要

本章では、Effekseerで背景を歪ませる方法について説明します。
最近のゲームでは、背景を歪ませられるエフェクトが存在します。
Effekseerでもパラメーターを設定することで、エフェクトで背景を歪ませれます。

<div align="center">
<img src="../../img/Tutorial/08_effect1.gif">
<p>本章で作成するエフェクト</p>
</div>

<p>あらかじめ作成途中のエフェクトを下記のリンクからダウンロードできるようにしました。</p>
<div align="center">
<p><a href = "../../Sample/08_01_Sample.zip">ダウンロード</a></p>
</div>

## 使い方

背景を歪ませるためには、歪みのための画像が必要です。
画像には色情報ではなく、歪み方を描きます。

歪み用の画像はほとんど法線画像と同じです。ただ、青色だけ扱いが異なります。
赤色は左右方向の歪みの強さを表します。127を中心として、0は左方向、255は右方向に歪ませます。
緑色は上下方向の歪みの強さを表します。127を中心として、0は上方向、255は下方向に歪ませます。

<div align="center">
<img src="../../img/Tutorial/06_ring_en.png">
<p>歪み画像</p>
</div>

effect1.efkprojを開いてください。

Texture/Distortion1.pngを描画共通パネルから、予め用意されているDistortionノードの色画像に設定します。

描画共通パネルから歪みにチェックを入れて有効にします。
背景が黒いままだと、わかりにくいのでオプションパネルから背景画像を設定するとわかりやすくなります。

図

上手く歪みを指定すると見栄えが良くなります。
ぜひ使ってみましょう。

## 歪み強度

描画共通パネルから歪み強度を変更すると、歪み方が変わります。
歪み強度が大きいほど、歪み方が強くなります。
歪み強度が0に近いほど、歪まなくなります。

図

## 描画優先度

基本的に歪みは背景を歪ませるのみで、自身のエフェクトは歪ませられません。
しかし、自身のエフェクトを歪ませたくなる場合があります。
そのようなときは深度パネルから描画優先度を変更します。

描画優先度はノード間の描画の順番を決めます。普通は、ノードツリーで下のほうに配置されているノードほど、後に描画されますが、
描画優先度が異なる場合、描画優先度が大きいノードが後に描画されます。

この描画優先度が-1以下のノードは、描画優先度が0以上の歪みが設定されているノードに歪ませられます。

Particleノードの描画優先度を変更しましょう。
描画優先度を変更すると、ParticleノードのパーティクルがDistortionノードに歪まされていることがわかります。

図

## 使用例

Effekseerの投稿エフェクトから歪みを使用したエフェクトを集めました。
基本的にはエフェクトの見栄えを良くするために使用されます。

<div align="center">
<img src="../../img/Tutorial/08_effect3.gif">
<p>歪みが使用された投稿エフェクト</p>
</div>

## 注意

他のゲームエンジンで再生した場合は見た目が変わることがあります。

最後に、本章で作成されたエフェクトをダウンロードできるようにしてみました。

<div align="center">
<a href = "../../Sample/10_02_Sample.zip">ダウンロード</a>
</div>

## まとめ

本章では、歪みについて説明しました。
上手く歪みを指定すると見栄えが良くなります。
ぜひ使ってみましょう。

</div>
